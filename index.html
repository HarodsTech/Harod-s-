<!DOCTYPE html>
<html lang="es">
<head>
      <!-- Configuración básica y charset -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Meta información esencial -->
    <title>Harod's Tech - Gestión de Clientes y Stock</title>
    <meta name="description" content="Sistema de gestión integral para administrar clientes y stock de servicios streaming. Harod's Tech ofrece control completo de cuentas Netflix, Disney+, HBO Max y más.">
    <meta name="keywords" content="gestión clientes, stock streaming, netflix, disney plus, hbo max, prime video, crunchyroll, spotify, administración cuentas">
    <meta name="author" content="Harod's Tech">
    <meta name="robots" content="index, follow">
    
    <!-- Meta tags para redes sociales -->
    <meta property="og:title" content="Harod's Tech - Gestión Completa">
    <meta property="og:description" content="Sistema profesional para gestión de clientes y stock de servicios streaming">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://harodstech.com">
    <meta property="og:image" content="https://harodstech.com/icon-192x192.png">
    <meta property="og:site_name" content="Harod's Tech">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Harod's Tech - Gestión Completa">
    <meta name="twitter:description" content="Sistema profesional para gestión de clientes y stock de servicios streaming">
    <meta name="twitter:image" content="https://harodstech.com/icon-192x192.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#bb86fc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Harod's Tech">
    
    <!-- Iconos para PWA -->
    <link rel="icon" type="image/png" href="icon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="icon-64x64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="icon-128x128.png" sizes="128x128">
    <link rel="icon" type="image/png" href="icon-256x256.png" sizes="256x256">
    <link rel="apple-touch-icon" href="icon-180x180.png">
    
    <!-- Safari pinned tab -->
    <link rel="mask-icon" href="icon.svg" color="#bb86fc">
    
    <!-- Microsoft Tiles -->
    <meta name="msapplication-TileColor" content="#121212">
    <meta name="msapplication-TileImage" content="icon-144x144.png">
    <meta name="msapplication-config" content="browserconfig.xml">
    
    <!-- Preconnects para mejor performance -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- CSS y Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #bb86fc;
            --secondary: #03dac6;
            --success: #00c853;
            --warning: #ffab00;
            --danger: #cf6679;
            --netflix: #e50914;
            --disney: #113ccf;
            --hbo: #9467fe;
            --prime: #00a8e1;
            --crunchyroll: #f47521;
            --spotify: #1db954;
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --bg-card: #2d2d2d;
            --bg-hover: #383838;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-muted: #888888;
            --border-color: #404040;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 8px 30px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(187, 134, 252, 0.3);
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 50%, #0f0f0f 100%);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, rgba(30, 30, 30, 0.95) 0%, rgba(45, 45, 45, 0.95) 100%);
            color: var(--text-primary);
            padding: 25px 0;
            text-align: center;
            border-radius: 0 0 20px 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
        }

        .logo {
            font-size: 2.8rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(187, 134, 252, 0.5);
        }

        .tagline {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 300;
            letter-spacing: 1px;
        }

        /* Navbar con botones */
        .navbar {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-primary);
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            min-height: 44px;
            box-shadow: var(--glow);
            font-size: 14px;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover), var(--glow);
        }

        /* Sección de login */
        .login-section {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            max-width: 450px;
            margin: 50px auto;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
        }

        .login-section h2 {
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 2rem;
            position: relative;
        }

        .login-section input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 1rem;
            transition: var(--transition);
            color: var(--text-primary);
            position: relative;
            z-index: 1;
        }

        .login-section input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(187, 134, 252, 0.2);
            outline: none;
            transform: scale(1.02);
        }

        .login-section button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-primary);
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            font-weight: 600;
            z-index: 1;
        }

        .login-section button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover), var(--glow);
        }

        /* Dashboard */
        .dashboard {
            display: none;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .welcome-message {
            font-size: 1.8rem;
            color: var(--primary);
            font-weight: 600;
            text-shadow: 0 0 10px rgba(187, 134, 252, 0.3);
        }

        .logout-btn {
            background: linear-gradient(135deg, var(--danger), #ff6b6b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(207, 102, 121, 0.4);
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border-color);
            flex-wrap: wrap;
            overflow-x: auto;
            gap: 5px;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            white-space: nowrap;
            position: relative;
            color: var(--text-secondary);
            font-weight: 500;
            border-radius: 10px 10px 0 0;
        }

        .tab.active {
            color: var(--primary);
            background: rgba(187, 134, 252, 0.1);
            border-bottom: 3px solid var(--primary);
        }

        .tab:hover:not(.active) {
            color: var(--text-primary);
            background: var(--bg-hover);
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Formularios */
        .client-form, .stock-form {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .client-form:hover, .stock-form:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-5px);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 1rem;
            transition: var(--transition);
            color: var(--text-primary);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(187, 134, 252, 0.2);
            outline: none;
            transform: scale(1.02);
        }

        .form-row {
            display: flex;
            gap: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        /* Botones */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            min-height: 44px;
            min-width: 44px;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-primary);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover), var(--glow);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #00e676);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 200, 83, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #ffd600);
            color: var(--bg-primary);
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 171, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #ff6b6b);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(207, 102, 121, 0.4);
        }

        /* Listas y tarjetas */
        .clients-list, .stock-list {
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
        }

        .client-item, .stock-item {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .client-item:hover, .stock-item:hover {
            background: var(--bg-hover);
            transform: translateX(5px);
        }

        .client-item:last-child, .stock-item:last-child {
            border-bottom: none;
        }

        .client-info, .stock-info {
            flex: 1;
            min-width: 250px;
        }

        .client-name, .stock-name {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .client-details, .stock-details {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .client-actions, .stock-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .status-overdue {
            color: var(--danger);
            font-weight: bold;
        }

        .status-pending {
            color: var(--warning);
            font-weight: bold;
        }

        .status-paid {
            color: var(--success);
            font-weight: bold;
        }

        /* Barra de búsqueda */
        .search-bar {
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
        }

        .search-bar input {
            flex: 1;
            padding: 12px 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
            color: var(--text-primary);
        }

        .search-bar input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(187, 134, 252, 0.2);
            outline: none;
            transform: scale(1.02);
        }

        .search-bar button {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-primary);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .search-bar button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover), var(--glow);
        }

        /* Grid de stock */
        .stock-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .stock-card {
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 25px;
            position: relative;
            border-top: 5px solid;
            transition: var(--transition);
            transform: translateY(0);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .stock-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-hover), var(--glow);
        }

        .stock-card.netflix {
            border-color: var(--netflix);
        }

        .stock-card.disney {
            border-color: var(--disney);
        }

        .stock-card.hbo {
            border-color: var(--hbo);
        }

        .stock-card.prime {
            border-color: var(--prime);
        }

        .stock-card.crunchyroll {
            border-color: var(--crunchyroll);
        }

        .stock-card.spotify {
            border-color: var(--spotify);
        }

        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .stock-title {
            font-weight: bold;
            font-size: 1.3rem;
            color: var(--text-primary);
        }

        .stock-count {
            font-size: 1.6rem;
            font-weight: bold;
        }

        .stock-email {
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .stock-profiles {
            margin-bottom: 20px;
        }

        .profile-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .profile-item:hover {
            background: var(--bg-hover);
            transform: translateX(5px);
            border-radius: 5px;
            padding-left: 10px;
        }

        .profile-item:last-child {
            border-bottom: none;
        }

        .stock-actions-card {
            display: flex;
            gap: 10px;
        }

        .stock-actions-card button {
            flex: 1;
        }

        .low-stock {
            color: var(--danger);
        }

        .medium-stock {
            color: var(--warning);
        }

        .high-stock {
            color: var(--success);
        }

        /* Mensajes */
        .loading {
            text-align: center;
            padding: 30px;
            color: var(--secondary);
            font-size: 1.1rem;
        }

        .error-message {
            background: linear-gradient(135deg, rgba(207, 102, 121, 0.1), rgba(255, 107, 107, 0.1));
            color: var(--danger);
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid var(--danger);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(207, 102, 121, 0.3);
        }

        .success-message {
            background: linear-gradient(135deg, rgba(0, 200, 83, 0.1), rgba(0, 230, 118, 0.1));
            color: var(--success);
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid var(--success);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 200, 83, 0.3);
        }

        /* Modales */
        .edit-stock-modal, .edit-client-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .edit-stock-content, .edit-client-content {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            color: var(--danger);
            transform: rotate(90deg);
            background: rgba(207, 102, 121, 0.1);
        }

        /* Menú móvil */
        .mobile-menu-btn {
            display: none;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            font-size: 1.5rem;
            color: var(--bg-primary);
            cursor: pointer;
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1001;
            transition: var(--transition);
            min-height: 44px;
            min-width: 44px;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }

        .mobile-tabs {
            display: none;
            flex-direction: column;
            background: var(--bg-card);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            position: relative;
            z-index: 999;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
        }

        .mobile-tabs.show {
            display: flex;
        }

        .mobile-tab {
            padding: 18px 20px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            min-height: 44px;
            color: var(--text-primary);
            position: relative;
            overflow: hidden;
        }

        .mobile-tab:last-child {
            border-bottom: none;
        }

        .mobile-tab.active {
            background: linear-gradient(135deg, rgba(187, 134, 252, 0.2), rgba(3, 218, 198, 0.1));
            color: var(--primary);
        }

        .mobile-tab:hover:not(.active) {
            background: var(--bg-hover);
            transform: translateX(5px);
            padding-left: 25px;
        }

        .mobile-tab i {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .logo {
                font-size: 2.2rem;
            }
            
            .navbar {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-btn {
                width: 100%;
                justify-content: center;
                font-size: 16px;
                padding: 15px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .search-bar {
                flex-direction: column;
            }
            
            .client-actions, .stock-actions {
                flex-direction: column;
            }
            
            .stock-grid {
                grid-template-columns: 1fr;
            }
            
            .mobile-menu-btn {
                display: flex;
            }
            
            .tabs {
                display: none;
            }
            
            .dashboard-header {
                flex-direction: column;
                text-align: center;
            }
            
            .welcome-message {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .login-section {
                padding: 25px;
                margin: 20px auto;
            }
            
            .client-form, .stock-form {
                padding: 20px;
            }
            
            .edit-stock-content, .edit-client-content {
                padding: 20px;
                margin: 10px;
            }
            
            .logo {
                font-size: 1.8rem;
            }
            
            .nav-btn {
                font-size: 14px;
                padding: 12px;
            }
        }

        /* Mejoras para inputs en móviles */
        input, select, textarea {
            font-size: 16px !important; /* Previene zoom en iOS */
        }
        
        /* Mejoras para botones táctiles */
        button {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">Harod's Tech</div>
            <div class="tagline">Gestión de Clientes y Stock</div>
            
            <!-- Navbar con botones -->
            <div class="navbar">
                <button class="nav-btn" data-tab="clients">
                    <i class="fas fa-users"></i> Clientes
                </button>
                <button class="nav-btn" data-tab="addClient">
                    <i class="fas fa-user-plus"></i> Agregar Cliente
                </button>
                <button class="nav-btn" data-tab="stock">
                    <i class="fas fa-boxes"></i> Stock
                </button>
                <button class="nav-btn" data-tab="addStock">
                    <i class="fas fa-plus-circle"></i> Agregar Stock
                </button>
                <button class="nav-btn" data-tab="backup">
                    <i class="fas fa-database"></i> Respaldo
                </button>
            </div>
        </div>
    </header>
    
    <div class="container">
        <!-- Sección de Login -->
        <div id="loginSection" class="login-section">
            <h2>Acceso Administrativo</h2>
            <p>Solo el propietario puede acceder a esta área</p>
            <input type="password" id="password" placeholder="Contraseña de acceso">
            <button id="loginBtn">Ingresar</button>
        </div>
        
        <!-- Dashboard (oculto inicialmente) -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-header">
                <div class="welcome-message">Bienvenido a Harod's Tech</div>
                <button id="logoutBtn" class="logout-btn">Cerrar Sesión</button>
            </div>
            
            <!-- Menú móvil -->
            <div class="mobile-tabs" id="mobileTabs">
                <div class="mobile-tab active" data-tab="clients">
                    <i class="fas fa-users"></i> Lista de Clientes
                </div>
                <div class="mobile-tab" data-tab="addClient">
                    <i class="fas fa-user-plus"></i> Agregar Cliente
                </div>
                <div class="mobile-tab" data-tab="stock">
                    <i class="fas fa-boxes"></i> Stock de Servicios
                </div>
                <div class="mobile-tab" data-tab="addStock">
                    <i class="fas fa-plus-circle"></i> Agregar Stock
                </div>
                <div class="mobile-tab" data-tab="backup">
                    <i class="fas fa-database"></i> Respaldo
                </div>
            </div>
            
            <!-- Menú de escritorio -->
            <div class="tabs">
                <div class="tab active" data-tab="clients">Lista de Clientes</div>
                <div class="tab" data-tab="addClient">Agregar Cliente</div>
                <div class="tab" data-tab="stock">Stock de Servicios</div>
                <div class="tab" data-tab="addStock">Agregar Stock</div>
                <div class="tab" data-tab="backup">Respaldo</div>
            </div>

            <!-- Mensajes de estado -->
            <div id="messageContainer"></div>
            
            <!-- Contenido de la pestaña Lista de Clientes -->
            <div id="clientsTab" class="tab-content active">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Buscar cliente...">
                    <button id="searchBtn">Buscar</button>
                    <button id="refreshClientsBtn" class="btn btn-primary">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>
                
                <div class="clients-list" id="clientsList">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i> Cargando clientes...
                    </div>
                </div>
            </div>
            
            <!-- Contenido de la pestaña Agregar Cliente -->
            <div id="addClientTab" class="tab-content">
                <div class="client-form">
                    <h3>Agregar Nuevo Cliente</h3>
                    <form id="addClientForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="clientName">Nombre del Cliente</label>
                                <input type="text" id="clientName" required>
                            </div>
                            <div class="form-group">
                                <label for="clientPhone">Número de Teléfono</label>
                                <input type="tel" id="clientPhone" placeholder="+504XXXXXXXX" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="serviceType">Cuenta de Servicio</label>
                                <select id="serviceType" required>
                                    <option value="">Selecciona una cuenta</option>
                                    <option value="Netflix">Netflix</option>
                                    <option value="Disney+">Disney+</option>
                                    <option value="HBO Max">HBO Max</option>
                                    <option value="Prime Video">Prime Video</option>
                                    <option value="Crunchyroll">Crunchyroll</option>
                                    <option value="Spotify">Spotify</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="profileAssigned">Perfil Asignado</label>
                                <select id="profileAssigned" required>
                                    <option value="">Selecciona un perfil</option>
                                    <option value="Perfil 1">Perfil 1</option>
                                    <option value="Perfil 2">Perfil 2</option>
                                    <option value="Perfil 3">Perfil 3</option>
                                    <option value="Perfil 4">Perfil 4</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="purchaseDate">Fecha de Compra</label>
                                <input type="date" id="purchaseDate" required>
                            </div>
                            <div class="form-group">
                                <label for="paymentDeadline">Fecha Límite de Pago</label>
                                <input type="date" id="paymentDeadline" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="loginDetails">Detalles de Acceso (usuario/contraseña)</label>
                            <textarea id="loginDetails" rows="3" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="paymentStatus">Estado de Pago</label>
                            <select id="paymentStatus">
                                <option value="pending">Pendiente</option>
                                <option value="paid">Pagado</option>
                                <option value="overdue">Vencido</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="clientNotes">Notas (opcional)</label>
                            <textarea id="clientNotes" rows="2" placeholder="Notas adicionales sobre el cliente..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Agregar Cliente
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Contenido de la pestaña Stock de Servicios -->
            <div id="stockTab" class="tab-content">
                <div class="search-bar">
                    <input type="text" id="stockSearchInput" placeholder="Buscar servicio...">
                    <button id="stockSearchBtn">Buscar</button>
                    <button id="refreshStockBtn" class="btn btn-primary">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>
                
                <div class="stock-grid" id="stockGrid">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i> Cargando stock...
                    </div>
                </div>
            </div>
            
            <!-- Contenido de la pestaña Agregar Stock -->
            <div id="addStockTab" class="tab-content">
                <div class="stock-form">
                    <h3>Agregar Nueva Cuenta</h3>
                    <form id="addStockForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="serviceName">Servicio</label>
                                <select id="serviceName" required>
                                    <option value="">Selecciona un servicio</option>
                                    <option value="Netflix">Netflix</option>
                                    <option value="Disney+">Disney+</option>
                                    <option value="HBO Max">HBO Max</option>
                                    <option value="Prime Video">Prime Video</option>
                                    <option value="Crunchyroll">Crunchyroll</option>
                                    <option value="Spotify">Spotify</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="accountName">Nombre de la Cuenta</label>
                                <input type="text" id="accountName" placeholder="Ej: Netflix Principal, Netflix Secundario" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="stockQuantity">Cupos Disponibles</label>
                                <input type="number" id="stockQuantity" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="totalCapacity">Capacidad Total</label>
                                <input type="number" id="totalCapacity" min="1" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="servicePrice">Precio del Servicio ($)</label>
                                <input type="number" id="servicePrice" min="0" step="0.01" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="accountEmail">Correo de la Cuenta</label>
                            <input type="email" id="accountEmail" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="accountPassword">Contraseña de la Cuenta</label>
                            <input type="text" id="accountPassword" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="profilesAvailable">Perfiles Disponibles (separados por coma)</label>
                            <input type="text" id="profilesAvailable" placeholder="Ej: Perfil 1, Perfil 2, Perfil 3" required>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Agregar Cuenta
                        </button>
                    </form>
                </div>
            </div>

            <!-- Contenido de la pestaña Respaldo -->
            <div id="backupTab" class="tab-content">
                <div class="backup-section">
                    <h3>Respaldo de Datos</h3>
                    <p>Gestiona tus archivos de datos y realiza respaldos.</p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <button id="exportDataBtn" class="btn btn-success">
                                <i class="fas fa-download"></i> Exportar Todos los Datos
                            </button>
                        </div>
                        <div class="form-group">
                            <button id="importDataBtn" class="btn btn-warning">
                                <i class="fas fa-upload"></i> Importar Datos
                            </button>
                            <input type="file" id="importFile" accept=".json" style="display: none;">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <button id="backupClientsBtn" class="btn btn-primary">
                                <i class="fas fa-file-export"></i> Respaldar Clientes
                            </button>
                        </div>
                        <div class="form-group">
                            <button id="backupStockBtn" class="btn btn-primary">
                                <i class="fas fa-file-export"></i> Respaldar Stock
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <h4>Archivos de Datos</h4>
                        <div id="fileList">
                            <div class="loading">Cargando archivos...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar stock -->
    <div id="editStockModal" class="edit-stock-modal">
        <div class="edit-stock-content">
            <div class="modal-header">
                <h3>Editar Cuenta</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="editStockForm">
                <input type="hidden" id="editStockId">
                <div class="form-group">
                    <label for="editServiceName">Servicio</label>
                    <input type="text" id="editServiceName" readonly>
                </div>
                <div class="form-group">
                    <label for="editAccountName">Nombre de la Cuenta</label>
                    <input type="text" id="editAccountName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editStockQuantity">Cupos Disponibles</label>
                        <input type="number" id="editStockQuantity" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="editTotalCapacity">Capacidad Total</label>
                        <input type="number" id="editTotalCapacity" min="1" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="editAccountEmail">Correo de la Cuenta</label>
                    <input type="email" id="editAccountEmail" required>
                </div>
                <div class="form-group">
                    <label for="editAccountPassword">Contraseña de la Cuenta</label>
                    <input type="text" id="editAccountPassword" required>
                </div>
                <div class="form-group">
                    <label for="editProfilesAvailable">Perfiles Disponibles (separados por coma)</label>
                    <input type="text" id="editProfilesAvailable" required>
                </div>
                <div class="form-group">
                    <label for="editServicePrice">Precio del Servicio ($)</label>
                    <input type="number" id="editServicePrice" min="0" step="0.01" required>
                </div>
                <div class="form-row">
                    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    <button type="button" class="btn btn-danger" id="cancelEditBtn">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para editar cliente -->
    <div id="editClientModal" class="edit-client-modal">
        <div class="edit-client-content">
            <div class="modal-header">
                <h3>Editar Cliente</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="editClientForm">
                <input type="hidden" id="editClientId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editClientName">Nombre del Cliente</label>
                        <input type="text" id="editClientName" required>
                    </div>
                    <div class="form-group">
                        <label for="editClientPhone">Número de Teléfono</label>
                        <input type="tel" id="editClientPhone" placeholder="+504XXXXXXXX" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editServiceType">Cuenta de Servicio</label>
                        <select id="editServiceType" required>
                            <option value="">Selecciona una cuenta</option>
                            <option value="Netflix">Netflix</option>
                            <option value="Disney+">Disney+</option>
                            <option value="HBO Max">HBO Max</option>
                            <option value="Prime Video">Prime Video</option>
                            <option value="Crunchyroll">Crunchyroll</option>
                            <option value="Spotify">Spotify</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editProfileAssigned">Perfil Asignado</label>
                        <select id="editProfileAssigned" required>
                            <option value="">Selecciona un perfil</option>
                            <option value="Perfil 1">Perfil 1</option>
                            <option value="Perfil 2">Perfil 2</option>
                            <option value="Perfil 3">Perfil 3</option>
                            <option value="Perfil 4">Perfil 4</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editPurchaseDate">Fecha de Compra</label>
                        <input type="date" id="editPurchaseDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editPaymentDeadline">Fecha Límite de Pago</label>
                        <input type="date" id="editPaymentDeadline" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="editLoginDetails">Detalles de Acceso (usuario/contraseña)</label>
                    <textarea id="editLoginDetails" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="editPaymentStatus">Estado de Pago</label>
                    <select id="editPaymentStatus">
                        <option value="pending">Pendiente</option>
                        <option value="paid">Pagado</option>
                        <option value="overdue">Vencido</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="editClientNotes">Notas (opcional)</label>
                    <textarea id="editClientNotes" rows="2" placeholder="Notas adicionales sobre el cliente..."></textarea>
                </div>
                
                <div class="form-row">
                    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    <button type="button" class="btn btn-danger" id="cancelEditClientBtn">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

<script>
    // Configuración
    const ACCESS_PASSWORD = "HarodTech2023";
    const SESSION_KEY = "harods_tech_session";

    // Elementos del DOM
    const loginSection = document.getElementById('loginSection');
    const dashboard = document.getElementById('dashboard');
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const passwordInput = document.getElementById('password');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    const clientsList = document.getElementById('clientsList');
    const addClientForm = document.getElementById('addClientForm');
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const stockGrid = document.getElementById('stockGrid');
    const addStockForm = document.getElementById('addStockForm');
    const stockSearchInput = document.getElementById('stockSearchInput');
    const stockSearchBtn = document.getElementById('stockSearchBtn');
    const refreshClientsBtn = document.getElementById('refreshClientsBtn');
    const refreshStockBtn = document.getElementById('refreshStockBtn');
    const messageContainer = document.getElementById('messageContainer');
    const exportDataBtn = document.getElementById('exportDataBtn');
    const importDataBtn = document.getElementById('importDataBtn');
    const importFile = document.getElementById('importFile');
    const backupClientsBtn = document.getElementById('backupClientsBtn');
    const backupStockBtn = document.getElementById('backupStockBtn');
    const fileList = document.getElementById('fileList');
    const navBtns = document.querySelectorAll('.nav-btn');
    
    // Elementos del modal de edición
    const editStockModal = document.getElementById('editStockModal');
    const editStockForm = document.getElementById('editStockForm');
    const closeModalBtn = document.querySelectorAll('.close-modal');
    const cancelEditBtn = document.getElementById('cancelEditBtn');

    // Elementos del modal de edición de cliente
    const editClientModal = document.getElementById('editClientModal');
    const editClientForm = document.getElementById('editClientForm');
    const cancelEditClientBtn = document.getElementById('cancelEditClientBtn');
    
    // Elementos móviles
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileTabsContainer = document.getElementById('mobileTabs');
    const mobileTabs = document.querySelectorAll('.mobile-tab');

    // Estado de la aplicación
    let clients = [];
    let stock = [];
    let currentEditingStock = null;
    let currentEditingClient = null;
    let isMobileMenuOpen = false;

    // Sistema de Sesión
    class SessionManager {
        static isLoggedIn() {
            return localStorage.getItem(SESSION_KEY) === 'true';
        }

        static login() {
            localStorage.setItem(SESSION_KEY, 'true');
        }

        static logout() {
            localStorage.removeItem(SESSION_KEY);
        }
    }

    // Utilidades
    function showMessage(message, type = 'success') {
        const messageDiv = document.createElement('div');
        messageDiv.className = type === 'error' ? 'error-message' : 'success-message';
        messageDiv.innerHTML = `
            <i class="fas ${type === 'error' ? 'fa-exclamation-triangle' : 'fa-check-circle'}"></i>
            ${message}
        `;
        messageContainer.innerHTML = '';
        messageContainer.appendChild(messageDiv);
        
        setTimeout(() => {
            messageDiv.remove();
        }, 5000);
    }

    function formatDate(dateString) {
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        return new Date(dateString).toLocaleDateString('es-ES', options);
    }

    function generateId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    // Sistema de Archivos (simulado con localStorage)
    class FileSystem {
        static saveToFile(filename, data) {
            try {
                localStorage.setItem(filename, JSON.stringify(data));
                return true;
            } catch (error) {
                console.error('Error guardando archivo:', error);
                return false;
            }
        }

        static loadFromFile(filename) {
            try {
                const fileData = localStorage.getItem(filename);
                if (!fileData) return null;
                return JSON.parse(fileData);
            } catch (error) {
                console.error('Error cargando archivo:', error);
                return null;
            }
        }

        static downloadFile(filename, content, type = 'text/plain') {
            const blob = new Blob([content], { type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        static listFiles() {
            const files = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('harods_tech_')) {
                    try {
                        const fileData = localStorage.getItem(key);
                        files.push({
                            name: key,
                            timestamp: new Date().toISOString(),
                            size: fileData.length
                        });
                    } catch (e) {
                        // Ignorar elementos que no son archivos válidos
                    }
                }
            }
            return files;
        }
    }

    // Funciones para Clientes
    async function loadClients() {
        try {
            clientsList.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Cargando clientes...</div>';
            
            const data = FileSystem.loadFromFile('harods_tech_clientes');
            clients = data || [];
            
            renderClients();
        } catch (error) {
            showMessage('Error cargando clientes: ' + error.message, 'error');
            clientsList.innerHTML = '<div class="error-message">Error al cargar los clientes</div>';
        }
    }

    async function saveClients() {
        const success = FileSystem.saveToFile('harods_tech_clientes', clients);
        if (!success) {
            showMessage('Error guardando clientes', 'error');
        }
        return success;
    }

    async function addClient(clientData) {
        try {
            const newClient = {
                id: generateId(),
                ...clientData,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            clients.push(newClient);
            const success = await saveClients();
            
            if (success) {
                showMessage('Cliente agregado exitosamente');
                await loadClients();
                return newClient;
            } else {
                throw new Error('Error guardando cliente');
            }
        } catch (error) {
            throw new Error('Error agregando cliente: ' + error.message);
        }
    }

    async function updateClient(clientId, clientData) {
        try {
            const index = clients.findIndex(c => c.id === clientId);
            if (index === -1) throw new Error('Cliente no encontrado');
            
            clients[index] = {
                ...clients[index],
                ...clientData,
                updatedAt: new Date().toISOString()
            };
            
            const success = await saveClients();
            if (success) {
                showMessage('Cliente actualizado exitosamente');
                await loadClients();
                return clients[index];
            } else {
                throw new Error('Error guardando cambios');
            }
        } catch (error) {
            throw new Error('Error actualizando cliente: ' + error.message);
        }
    }

    async function deleteClient(clientId) {
        try {
            clients = clients.filter(c => c.id !== clientId);
            const success = await saveClients();
            
            if (success) {
                showMessage('Cliente eliminado exitosamente');
                await loadClients();
            } else {
                throw new Error('Error guardando cambios');
            }
        } catch (error) {
            throw new Error('Error eliminando cliente: ' + error.message);
        }
    }

    // Funciones para Stock
    async function loadStock() {
        try {
            stockGrid.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Cargando stock...</div>';
            
            const data = FileSystem.loadFromFile('harods_tech_stock');
            stock = data || [];
            
            renderStock();
        } catch (error) {
            showMessage('Error cargando stock: ' + error.message, 'error');
            stockGrid.innerHTML = '<div class="error-message">Error al cargar el stock</div>';
        }
    }

    async function saveStock() {
        const success = FileSystem.saveToFile('harods_tech_stock', stock);
        if (!success) {
            showMessage('Error guardando stock', 'error');
        }
        return success;
    }

    async function addStock(stockData) {
        try {
            const newStock = {
                id: generateId(),
                ...stockData,
                profiles: stockData.profiles.split(',').map(p => p.trim()),
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            stock.push(newStock);
            
            const success = await saveStock();
            
            if (success) {
                showMessage('Cuenta agregada exitosamente');
                await loadStock();
                return stock;
            } else {
                throw new Error('Error guardando stock');
            }
        } catch (error) {
            throw new Error('Error agregando stock: ' + error.message);
        }
    }

    async function updateStock(stockId, stockData) {
        try {
            const index = stock.findIndex(s => s.id === stockId);
            if (index === -1) throw new Error('Stock no encontrado');
            
            stock[index] = {
                ...stock[index],
                ...stockData,
                profiles: stockData.profiles.split(',').map(p => p.trim()),
                updatedAt: new Date().toISOString()
            };
            
            const success = await saveStock();
            if (success) {
                showMessage('Cuenta actualizada exitosamente');
                await loadStock();
                return stock[index];
            } else {
                throw new Error('Error guardando cambios');
            }
        } catch (error) {
            throw new Error('Error actualizando stock: ' + error.message);
        }
    }

    async function deleteStock(stockId) {
        try {
            stock = stock.filter(s => s.id !== stockId);
            const success = await saveStock();
            
            if (success) {
                showMessage('Cuenta eliminada exitosamente');
                await loadStock();
            } else {
                throw new Error('Error guardando cambios');
            }
        } catch (error) {
            throw new Error('Error eliminando stock: ' + error.message);
        }
    }

    // Funciones de Renderizado
    function renderClients() {
        clientsList.innerHTML = '';
        
        if (clients.length === 0) {
            clientsList.innerHTML = '<div class="client-item">No se encontraron clientes</div>';
            return;
        }
        
        clients.forEach(client => {
            const clientItem = document.createElement('div');
            clientItem.className = 'client-item';
            
            const statusClass = `status-${client.status}`;
            const statusText = client.status === 'paid' ? 'Pagado' : 
                             client.status === 'overdue' ? 'Vencido' : 'Pendiente';
            
            clientItem.innerHTML = `
                <div class="client-info">
                    <div class="client-name">${client.name}</div>
                    <div class="client-details">
                        <div><strong>Teléfono:</strong> ${client.phone}</div>
                        <div><strong>Cuenta:</strong> ${client.service} - ${client.profile}</div>
                        <div><strong>Compra:</strong> ${formatDate(client.purchaseDate)}</div>
                        <div><strong>Vence:</strong> ${formatDate(client.paymentDeadline)}</div>
                        <div><strong>Acceso:</strong> ${client.loginDetails}</div>
                        <div class="${statusClass}"><strong>Estado:</strong> ${statusText}</div>
                        ${client.notes ? `<div><strong>Notas:</strong> ${client.notes}</div>` : ''}
                    </div>
                </div>
                <div class="client-actions">
                    <button class="btn btn-warning" onclick="handleEditClient('${client.id}')">
                        <i class="fas fa-edit"></i> Editar
                    </button>
                    <button class="btn btn-success" onclick="handleSendReminder('${client.id}')">
                        <i class="fas fa-bell"></i> Recordatorio
                    </button>
                    <button class="btn btn-primary" onclick="handleMarkAsPaid('${client.id}')">
                        <i class="fas fa-check-circle"></i> Pagado
                    </button>
                    <button class="btn btn-danger" onclick="handleCancelSubscription('${client.id}')">
                        <i class="fas fa-times-circle"></i> Cancelar
                    </button>
                </div>
            `;
            
            clientsList.appendChild(clientItem);
        });
    }

    function renderStock() {
        stockGrid.innerHTML = '';
        
        if (stock.length === 0) {
            stockGrid.innerHTML = '<div class="stock-item">No se encontraron cuentas en stock</div>';
            return;
        }
        
        stock.forEach(item => {
            const stockCard = document.createElement('div');
            stockCard.className = `stock-card ${item.service.toLowerCase().replace('+', '').replace(' ', '')}`;
            
            let stockClass = '';
            if (item.quantity === 0) {
                stockClass = 'low-stock';
            } else if (item.quantity <= item.total * 0.3) {
                stockClass = 'low-stock';
            } else if (item.quantity <= item.total * 0.6) {
                stockClass = 'medium-stock';
            } else {
                stockClass = 'high-stock';
            }
            
            stockCard.innerHTML = `
                <div class="stock-header">
                    <div class="stock-title">${item.accountName || item.service}</div>
                    <div class="stock-count ${stockClass}">${item.quantity}/${item.total}</div>
                </div>
                <div class="stock-details">
                    <div><strong>Servicio:</strong> ${item.service}</div>
                    <div><strong>Email:</strong> ${item.email}</div>
                    <div><strong>Precio:</strong> $${item.price}</div>
                </div>
                <div class="stock-profiles">
                    <div><strong>Perfiles disponibles (${item.profiles.length}):</strong></div>
                    ${item.profiles.map(profile => `
                        <div class="profile-item">
                            <span>${profile}</span>
                            <span>
                                <button class="btn btn-primary btn-sm" onclick="handleAssignProfile('${item.id}', '${profile}')">
                                    <i class="fas fa-user-plus"></i> Asignar
                                </button>
                            </span>
                        </div>
                    `).join('')}
                </div>
                <div class="stock-actions-card">
                    <button class="btn btn-warning" onclick="handleEditStock('${item.id}')">
                        <i class="fas fa-edit"></i> Editar
                    </button>
                    <button class="btn btn-danger" onclick="handleDeleteStock('${item.id}')">
                        <i class="fas fa-trash"></i> Eliminar
                    </button>
                </div>
            `;
            
            stockGrid.appendChild(stockCard);
        });
    }

    // Funciones del Modal de Edición
    function openEditStockModal(stockId) {
        const stockItem = stock.find(s => s.id === stockId);
        if (!stockItem) {
            showMessage('Cuenta no encontrada', 'error');
            return;
        }

        currentEditingStock = stockItem;
        
        // Llenar el formulario con los datos actuales
        document.getElementById('editStockId').value = stockItem.id;
        document.getElementById('editServiceName').value = stockItem.service;
        document.getElementById('editAccountName').value = stockItem.accountName || stockItem.service;
        document.getElementById('editStockQuantity').value = stockItem.quantity;
        document.getElementById('editTotalCapacity').value = stockItem.total;
        document.getElementById('editAccountEmail').value = stockItem.email;
        document.getElementById('editAccountPassword').value = stockItem.password;
        document.getElementById('editProfilesAvailable').value = stockItem.profiles.join(', ');
        document.getElementById('editServicePrice').value = stockItem.price;
        
        editStockModal.style.display = 'flex';
    }

    function closeEditStockModal() {
        editStockModal.style.display = 'none';
        currentEditingStock = null;
        editStockForm.reset();
    }

    function openEditClientModal(clientId) {
        const client = clients.find(c => c.id === clientId);
        if (!client) {
            showMessage('Cliente no encontrada', 'error');
            return;
        }

        currentEditingClient = client;
        
        // Llenar el formulario con los datos actuales
        document.getElementById('editClientId').value = client.id;
        document.getElementById('editClientName').value = client.name;
        document.getElementById('editClientPhone').value = client.phone;
        document.getElementById('editPurchaseDate').value = client.purchaseDate;
        document.getElementById('editPaymentDeadline').value = client.paymentDeadline;
        document.getElementById('editLoginDetails').value = client.loginDetails;
        document.getElementById('editPaymentStatus').value = client.status;
        document.getElementById('editClientNotes').value = client.notes || '';
        document.getElementById('editServiceType').value = client.service;
        document.getElementById('editProfileAssigned').value = client.profile;
        
        editClientModal.style.display = 'flex';
    }

    function closeEditClientModal() {
        editClientModal.style.display = 'none';
        currentEditingClient = null;
        editClientForm.reset();
    }

    // Funciones de Respaldo
    function exportAllData() {
        const data = {
            clients: clients,
            stock: stock,
            exportDate: new Date().toISOString(),
            version: '1.0'
        };
        
        const content = JSON.stringify(data, null, 2);
        const filename = `harods_tech_respaldo_${new Date().toISOString().split('T')[0]}.json`;
        
        FileSystem.downloadFile(filename, content, 'application/json');
        showMessage('Datos exportados exitosamente');
    }

    function importData(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                
                if (data.clients && data.stock) {
                    clients = data.clients;
                    stock = data.stock;
                    
                    saveClients();
                    saveStock();
                    
                    loadClients();
                    loadStock();
                    
                    showMessage('Datos importados exitosamente');
                } else {
                    showMessage('Archivo de respaldo inválido', 'error');
                }
            } catch (error) {
                showMessage('Error importando datos: ' + error.message, 'error');
            }
        };
        reader.readAsText(file);
    }

    function backupClients() {
        const content = JSON.stringify(clients, null, 2);
        const filename = `clientes_respaldo_${new Date().toISOString().split('T')[0]}.json`;
        FileSystem.downloadFile(filename, content, 'application/json');
        showMessage('Clientes respaldados exitosamente');
    }

    function backupStock() {
        const content = JSON.stringify(stock, null, 2);
        const filename = `stock_respaldo_${new Date().toISOString().split('T')[0]}.json`;
        FileSystem.downloadFile(filename, content, 'application/json');
        showMessage('Stock respaldado exitosamente');
    }

    function renderFileList() {
        const files = FileSystem.listFiles();
        fileList.innerHTML = '';
        
        if (files.length === 0) {
            fileList.innerHTML = '<div class="client-item">No hay archivos de datos</div>';
            return;
        }
        
        files.forEach(file => {
            const fileItem = document.createElement('div');
            fileItem.className = 'client-item';
            fileItem.innerHTML = `
                <div class="client-info">
                    <div class="client-name">${file.name}</div>
                    <div class="client-details">
                        <div><strong>Fecha:</strong> ${new Date(file.timestamp).toLocaleString()}</div>
                        <div><strong>Tamaño:</strong> ${file.size} bytes</div>
                    </div>
                </div>
                <div class="client-actions">
                    <button class="btn btn-primary" onclick="downloadFile('${file.name}')">
                        <i class="fas fa-download"></i> Descargar
                    </button>
                </div>
            `;
            fileList.appendChild(fileItem);
        });
    }

    function downloadFile(filename) {
        const content = localStorage.getItem(filename);
        if (content) {
            FileSystem.downloadFile(filename, content, 'application/json');
        }
    }

    // ========== FUNCIONES DEL MENÚ MÓVIL ==========
    function initMobileMenu() {
        if (!mobileMenuBtn || !mobileTabsContainer) {
            return;
        }

        // Función para abrir el menú
        function openMobileMenu() {
            mobileTabsContainer.style.display = 'flex';
            isMobileMenuOpen = true;
            mobileMenuBtn.innerHTML = '<i class="fas fa-times"></i>';
        }

        // Función para cerrar el menú
        function closeMobileMenu() {
            mobileTabsContainer.style.display = 'none';
            isMobileMenuOpen = false;
            mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
        }

        // Función para alternar el menú
        function toggleMobileMenu() {
            if (isMobileMenuOpen) {
                closeMobileMenu();
            } else {
                openMobileMenu();
            }
        }

        // Event listener para el botón del menú
        mobileMenuBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            toggleMobileMenu();
        });

        // Event listeners para las pestañas móviles
        mobileTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
                closeMobileMenu();
            });
        });

        // Cerrar menú al hacer clic fuera
        document.addEventListener('click', function(e) {
            if (isMobileMenuOpen && 
                !mobileTabsContainer.contains(e.target) && 
                !mobileMenuBtn.contains(e.target)) {
                closeMobileMenu();
            }
        });

        // Cerrar menú con tecla Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && isMobileMenuOpen) {
                closeMobileMenu();
            }
        });

        // Cerrar menú al cambiar el tamaño de la ventana
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768 && isMobileMenuOpen) {
                closeMobileMenu();
            }
        });
    }

    // ========== FUNCIÓN PARA CAMBIAR PESTAÑAS ==========
    function switchTab(tabId) {
        // Ocultar todas las pestañas
        tabs.forEach(t => t.classList.remove('active'));
        mobileTabs.forEach(t => t.classList.remove('active'));
        tabContents.forEach(tc => tc.classList.remove('active'));
        
        // Activar pestaña seleccionada
        const selectedTab = document.querySelector(`[data-tab="${tabId}"]`);
        const selectedContent = document.getElementById(tabId + 'Tab');
        
        if (selectedTab && selectedContent) {
            selectedTab.classList.add('active');
            selectedContent.classList.add('active');
            
            // Cargar contenido específico si es necesario
            if (tabId === 'backup') {
                renderFileList();
            }
        }
    }

    // ========== MANEJADORES DE EVENTOS ==========
    async function handleSendReminder(clientId) {
        try {
            const client = clients.find(c => c.id === clientId);
            const message = `Hola ${client.name}, este es un recordatorio de que tu pago para ${client.service} vence el ${formatDate(client.paymentDeadline)}. - Harod's Tech`;
            const whatsappUrl = `https://wa.me/${client.phone}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            
            showMessage('Recordatorio enviado por WhatsApp');
        } catch (error) {
            showMessage(error.message, 'error');
        }
    }

    async function handleMarkAsPaid(clientId) {
        try {
            const client = clients.find(c => c.id === clientId);
            if (!client) {
                throw new Error('Cliente no encontrado');
            }
            
            await updateClient(clientId, { 
                ...client,
                status: 'paid'
            });
            
            const message = `Hola ${client.name}, hemos registrado tu pago para ${client.service}. ¡Gracias! - Harod's Tech`;
            const whatsappUrl = `https://wa.me/${client.phone}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            
        } catch (error) {
            showMessage(error.message, 'error');
        }
    }

    async function handleCancelSubscription(clientId) {
        const client = clients.find(c => c.id === clientId);
        
        if (!client) {
            showMessage('Cliente no encontrado', 'error');
            return;
        }
        
        if (!confirm(`¿Estás seguro de cancelar la suscripción de ${client.name}?`)) {
            return;
        }
        
        try {
            // Eliminar el cliente
            await deleteClient(clientId);
            
            const message = `Hola ${client.name}, tu suscripción para ${client.service} ha sido cancelada. - Harod's Tech`;
            const whatsappUrl = `https://wa.me/${client.phone}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            
        } catch (error) {
            showMessage(error.message, 'error');
        }
    }

    async function handleAssignProfile(stockId, profileName) {
        try {
            // Cambiar a la pestaña de agregar cliente
            switchTab('addClient');
            
            // Rellenar automáticamente la cuenta y perfil
            const stockItem = stock.find(s => s.id === stockId);
            if (stockItem) {
                document.getElementById('serviceType').value = stockItem.service;
                document.getElementById('profileAssigned').value = profileName;
                
                // Llenar automáticamente los detalles de acceso
                document.getElementById('loginDetails').value = `Email: ${stockItem.email}\nContraseña: ${stockItem.password}`;
            }
            
        } catch (error) {
            showMessage(error.message, 'error');
        }
    }

    async function handleEditStock(stockId) {
        openEditStockModal(stockId);
    }

    async function handleEditClient(clientId) {
        openEditClientModal(clientId);
    }

    async function handleDeleteStock(stockId) {
        const stockItem = stock.find(s => s.id === stockId);
        if (!stockItem) return;
        
        if (!confirm(`¿Estás seguro de eliminar la cuenta ${stockItem.accountName || stockItem.service}?`)) {
            return;
        }
        
        try {
            await deleteStock(stockId);
        } catch (error) {
            showMessage(error.message, 'error');
        }
    }

    // ========== INICIALIZACIÓN ==========
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Inicializando aplicación...');
        
        // Verificar si hay sesión activa
        if (SessionManager.isLoggedIn()) {
            loginSection.style.display = 'none';
            dashboard.style.display = 'block';
            showMessage('Sesión recuperada correctamente');
        } else {
            loginSection.style.display = 'block';
            dashboard.style.display = 'none';
        }

        // Establecer fechas por defecto
        const today = new Date().toISOString().split('T')[0];
        const nextMonth = new Date();
        nextMonth.setMonth(nextMonth.getMonth() + 1);
        const nextMonthFormatted = nextMonth.toISOString().split('T')[0];
        
        if (document.getElementById('purchaseDate')) {
            document.getElementById('purchaseDate').value = today;
        }
        if (document.getElementById('paymentDeadline')) {
            document.getElementById('paymentDeadline').value = nextMonthFormatted;
        }
        
        // Cargar datos iniciales
        loadClients();
        loadStock();
        renderFileList();
        
        // Inicializar funcionalidades
        initMobileMenu();
        
        // Event listeners para las pestañas de escritorio
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
            });
        });

        // Event listeners para los botones del navbar
        navBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
            });
        });

        console.log('Aplicación inicializada correctamente');
    });

    // ========== EVENT LISTENERS PRINCIPALES ==========
    if (loginBtn) {
        loginBtn.addEventListener('click', function() {
            if (passwordInput.value === ACCESS_PASSWORD) {
                SessionManager.login();
                loginSection.style.display = 'none';
                dashboard.style.display = 'block';
                showMessage('Sesión iniciada correctamente');
            } else {
                showMessage('Contraseña incorrecta. Solo el propietario puede acceder.', 'error');
                passwordInput.value = '';
            }
        });
    }

    if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
            SessionManager.logout();
            dashboard.style.display = 'none';
            loginSection.style.display = 'block';
            passwordInput.value = '';
            showMessage('Sesión cerrada correctamente');
        });
    }

    if (addClientForm) {
        addClientForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            console.log('Enviando formulario de cliente...');
            
            const clientData = {
                name: document.getElementById('clientName').value,
                phone: document.getElementById('clientPhone').value,
                service: document.getElementById('serviceType').value,
                profile: document.getElementById('profileAssigned').value,
                purchaseDate: document.getElementById('purchaseDate').value,
                paymentDeadline: document.getElementById('paymentDeadline').value,
                loginDetails: document.getElementById('loginDetails').value,
                status: document.getElementById('paymentStatus').value,
                notes: document.getElementById('clientNotes').value
            };
            
            try {
                await addClient(clientData);
                addClientForm.reset();
                
                // Restablecer fechas
                const today = new Date().toISOString().split('T')[0];
                const nextMonth = new Date();
                nextMonth.setMonth(nextMonth.getMonth() + 1);
                const nextMonthFormatted = nextMonth.toISOString().split('T')[0];
                
                document.getElementById('purchaseDate').value = today;
                document.getElementById('paymentDeadline').value = nextMonthFormatted;
                
            } catch (error) {
                showMessage(error.message, 'error');
            }
        });
    }

    if (addStockForm) {
        addStockForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            console.log('Enviando formulario de stock...');
            
            const stockData = {
                service: document.getElementById('serviceName').value,
                accountName: document.getElementById('accountName').value,
                quantity: parseInt(document.getElementById('stockQuantity').value),
                total: parseInt(document.getElementById('totalCapacity').value),
                email: document.getElementById('accountEmail').value,
                password: document.getElementById('accountPassword').value,
                profiles: document.getElementById('profilesAvailable').value,
                price: parseFloat(document.getElementById('servicePrice').value)
            };
            
            try {
                await addStock(stockData);
                addStockForm.reset();
            } catch (error) {
                showMessage(error.message, 'error');
            }
        });
    }

    // Eventos del modal de edición
    if (editStockForm) {
        editStockForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const stockData = {
                service: document.getElementById('editServiceName').value,
                accountName: document.getElementById('editAccountName').value,
                quantity: parseInt(document.getElementById('editStockQuantity').value),
                total: parseInt(document.getElementById('editTotalCapacity').value),
                email: document.getElementById('editAccountEmail').value,
                password: document.getElementById('editAccountPassword').value,
                profiles: document.getElementById('editProfilesAvailable').value,
                price: parseFloat(document.getElementById('editServicePrice').value)
            };
            
            try {
                await updateStock(currentEditingStock.id, stockData);
                closeEditStockModal();
            } catch (error) {
                showMessage(error.message, 'error');
            }
        });
    }

    if (editClientForm) {
        editClientForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const clientData = {
                name: document.getElementById('editClientName').value,
                phone: document.getElementById('editClientPhone').value,
                service: document.getElementById('editServiceType').value,
                profile: document.getElementById('editProfileAssigned').value,
                purchaseDate: document.getElementById('editPurchaseDate').value,
                paymentDeadline: document.getElementById('editPaymentDeadline').value,
                loginDetails: document.getElementById('editLoginDetails').value,
                status: document.getElementById('editPaymentStatus').value,
                notes: document.getElementById('editClientNotes').value
            };
            
            try {
                await updateClient(currentEditingClient.id, clientData);
                closeEditClientModal();
            } catch (error) {
                showMessage(error.message, 'error');
            }
        });
    }

    if (closeModalBtn) {
        closeModalBtn.forEach(btn => {
            btn.addEventListener('click', function() {
                closeEditStockModal();
                closeEditClientModal();
            });
        });
    }

    if (cancelEditBtn) {
        cancelEditBtn.addEventListener('click', closeEditStockModal);
    }

    if (cancelEditClientBtn) {
        cancelEditClientBtn.addEventListener('click', closeEditClientModal);
    }

    // Cerrar modal al hacer clic fuera
    if (editStockModal) {
        editStockModal.addEventListener('click', function(e) {
            if (e.target === editStockModal) {
                closeEditStockModal();
            }
        });
    }

    if (editClientModal) {
        editClientModal.addEventListener('click', function(e) {
            if (e.target === editClientModal) {
                closeEditClientModal();
            }
        });
    }

    if (refreshClientsBtn) {
        refreshClientsBtn.addEventListener('click', loadClients);
    }

    if (refreshStockBtn) {
        refreshStockBtn.addEventListener('click', loadStock);
    }

    // Eventos de respaldo
    if (exportDataBtn) {
        exportDataBtn.addEventListener('click', exportAllData);
    }
    
    if (importDataBtn) {
        importDataBtn.addEventListener('click', function() {
            importFile.click();
        });
    }
    
    if (importFile) {
        importFile.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                importData(e.target.files[0]);
            }
        });
    }
    
    if (backupClientsBtn) {
        backupClientsBtn.addEventListener('click', backupClients);
    }
    
    if (backupStockBtn) {
        backupStockBtn.addEventListener('click', backupStock);
    }

    // Funciones globales para los botones
    window.handleSendReminder = handleSendReminder;
    window.handleMarkAsPaid = handleMarkAsPaid;
    window.handleCancelSubscription = handleCancelSubscription;
    window.handleAssignProfile = handleAssignProfile;
    window.handleEditStock = handleEditStock;
    window.handleEditClient = handleEditClient;
    window.handleDeleteStock = handleDeleteStock;
    window.downloadFile = downloadFile;
</script>
</body>
  </html>
